# Solidity Vulnerability Checklist (SWC Registry)

## Critical

### SWC-107: Reentrancy
- **Detect**: `call{value:`, `.transfer(`, `.send(` before state updates
- **Fix**: CEI pattern + ReentrancyGuard
```solidity
// BAD: state update after external call
(bool s, ) = to.call{value: amt}("");
balances[msg.sender] -= amt;

// GOOD: CEI
balances[msg.sender] -= amt;
(bool s, ) = to.call{value: amt}("");
```

### SWC-106: Unprotected Self-Destruct
- **Detect**: `selfdestruct(` without access control
- **Fix**: Restrict to owner, consider removing entirely (deprecated post-Cancun)

### SWC-105: Unprotected Ether Withdrawal
- **Detect**: `call{value:`, `transfer(`, `send(` without auth checks
- **Fix**: Add `onlyOwner` or role-based modifier

### SWC-104: Unchecked Call Return Value
- **Detect**: `.call(` without checking return bool
- **Fix**: `(bool success, ) = addr.call(...); require(success);`

## High

### SWC-101: Integer Overflow/Underflow
- **Detect**: Arithmetic in `unchecked` blocks, Solidity <0.8
- **Fix**: Use 0.8+ default checks; document unchecked blocks

### SWC-115: Authorization through tx.origin
- **Detect**: `tx.origin` in require/if statements
- **Fix**: Always use `msg.sender`

### SWC-112: Delegatecall to Untrusted Callee
- **Detect**: `delegatecall` with user-supplied address
- **Fix**: Whitelist implementation addresses

### SWC-124: Write to Arbitrary Storage Location
- **Detect**: User-controlled storage writes, dynamic arrays without bounds
- **Fix**: Validate array indices, use mappings

### SWC-116: Block Timestamp Dependence
- **Detect**: `block.timestamp` for critical logic
- **Fix**: Accept ~15s variance; don't use for randomness

## Medium

### SWC-100: Function Default Visibility
- **Detect**: Functions without explicit visibility
- **Fix**: Always specify `public`, `external`, `internal`, or `private`

### SWC-103: Floating Pragma
- **Detect**: `pragma solidity ^0.8.0;`
- **Fix**: Pin exact version for deployments: `pragma solidity 0.8.28;`

### SWC-108: State Variable Default Visibility
- **Detect**: State variables without visibility
- **Fix**: Always specify visibility

### SWC-111: Use of Deprecated Functions
- **Detect**: `suicide(`, `sha3(`, `callcode(`, `throw`
- **Fix**: Use modern equivalents

### SWC-113: DoS with Failed Call
- **Detect**: Loops with external calls, push pattern
- **Fix**: Pull-over-push pattern for payments

### SWC-114: Transaction Order Dependence
- **Detect**: approve/transferFrom without allowance reset
- **Fix**: Use `increaseAllowance`/`decreaseAllowance` or permit

### SWC-120: Weak Sources of Randomness
- **Detect**: `block.timestamp`, `block.prevrandao`, `blockhash` for randomness
- **Fix**: Use Chainlink VRF or commit-reveal

### SWC-131: Presence of Unused Variables
- **Detect**: Declared but unused variables
- **Fix**: Remove them

### SWC-135: Code with No Effects
- **Detect**: Statements that don't change state or revert
- **Fix**: Remove dead code

### SWC-136: Unencrypted Private Data
- **Detect**: Sensitive data in `private` state variables
- **Fix**: All on-chain data is public; encrypt off-chain before storing

## Low

### SWC-102: Outdated Compiler Version
- **Detect**: Solidity < 0.8.20
- **Fix**: Use latest stable (0.8.28+)

### SWC-109: Uninitialized Storage Pointer
- **Detect**: `storage` reference without initialization (older Solidity)
- **Fix**: Use 0.8+ (compiler prevents this)

### SWC-118: Incorrect Constructor Name
- **Detect**: Constructor name != contract name (Solidity <0.4.22)
- **Fix**: Use `constructor()` keyword

### SWC-119: Shadowing State Variables
- **Detect**: Local variable or inherited variable shadows state
- **Fix**: Rename to avoid shadowing
